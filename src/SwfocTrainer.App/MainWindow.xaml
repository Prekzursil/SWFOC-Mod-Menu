<Window x:Class="SwfocTrainer.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="SWFOC Trainer Editor" Height="900" Width="1400"
        MinWidth="1024" MinHeight="700"
        Background="#111822"
        Foreground="#E6EDF7">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
            <TextBlock Text="Profile:" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <ComboBox Width="320" ItemsSource="{Binding Profiles}" SelectedItem="{Binding SelectedProfileId}"/>
            <Button Content="Load Profiles" Command="{Binding LoadProfilesCommand}" Margin="8,0,0,0"/>
            <Button Content="Load Actions" Command="{Binding LoadActionsCommand}" Margin="8,0,0,0"/>
            <Button Content="Attach" Command="{Binding AttachCommand}" Margin="8,0,0,0"/>
            <Button Content="Detach" Command="{Binding DetachCommand}" Margin="8,0,0,0"/>
            <TextBlock Text="  Mode:" VerticalAlignment="Center" Margin="12,0,4,0"/>
            <TextBlock Text="{Binding RuntimeMode}" VerticalAlignment="Center"/>
            <TextBlock Text="  Symbols:" VerticalAlignment="Center" Margin="12,0,4,0"/>
            <TextBlock Text="{Binding ResolvedSymbolsCount}" VerticalAlignment="Center"/>
        </StackPanel>

        <TabControl Grid.Row="1" Background="#182132" BorderThickness="0">
            <TabItem Header="Runtime">
                <Grid Margin="12">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Action:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <ComboBox Width="380" ItemsSource="{Binding Actions}" SelectedItem="{Binding SelectedActionId}"/>
                        <Button Content="Execute" Command="{Binding ExecuteActionCommand}" Margin="8,0,0,0"/>
                    </StackPanel>

                    <!-- Quick-Action Buttons -->
                    <GroupBox Header="Quick Actions" Grid.Row="1" Margin="0,10,0,0" Padding="6">
                        <StackPanel>
                            <!-- Credits row: value input + freeze toggle + set button -->
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                <TextBlock Text="ðŸ’° Credits:" VerticalAlignment="Center" Margin="4,0,6,0"/>
                                <TextBox Text="{Binding CreditsValue, UpdateSourceTrigger=PropertyChanged}" Width="110" VerticalAlignment="Center" Padding="4,2"/>
                                <CheckBox Content="Freeze" IsChecked="{Binding CreditsFreeze}" VerticalAlignment="Center" Margin="8,0,8,0"/>
                                <Button Content="Set Credits" Command="{Binding QuickSetCreditsCommand}" Padding="8,4"/>
                            </StackPanel>
                            <WrapPanel>
                                <Button Content="â±ï¸ Freeze Timer" Command="{Binding QuickFreezeTimerCommand}" Margin="2" Padding="8,4"/>
                                <Button Content="ðŸ—ºï¸ Toggle Fog" Command="{Binding QuickToggleFogCommand}" Margin="2" Padding="8,4"/>
                                <Button Content="ðŸ¤– Toggle AI" Command="{Binding QuickToggleAiCommand}" Margin="2" Padding="8,4"/>
                                <Button Content="âš¡ Instant Build Patch" Command="{Binding QuickInstantBuildCommand}" Margin="2" Padding="8,4"/>
                                <Button Content="ðŸ—ï¸ Unit Cap 99k" Command="{Binding QuickUnitCapCommand}" Margin="2" Padding="8,4"/>
                                <Button Content="ðŸ›¡ï¸ God Mode" Command="{Binding QuickGodModeCommand}" Margin="2" Padding="8,4"/>
                                <Button Content="ðŸ’¥ One Hit Kill" Command="{Binding QuickOneHitCommand}" Margin="2" Padding="8,4"/>
                                <Button Content="ðŸ”“ Unfreeze All" Command="{Binding QuickUnfreezeAllCommand}" Margin="2" Padding="8,4"/>
                            </WrapPanel>
                        </StackPanel>
                    </GroupBox>

                    <Grid Grid.Row="2" Margin="0,12,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <GroupBox Header="Payload JSON" Margin="0,0,8,0">
                            <TextBox Text="{Binding PayloadJson}" AcceptsReturn="True" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"/>
                        </GroupBox>

                        <Grid Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Active Freezes Panel -->
                            <GroupBox Header="Active Freezes" Margin="0,0,0,8">
                                <ListBox ItemsSource="{Binding ActiveFreezes}" Height="80" FontFamily="Consolas" FontSize="11"/>
                            </GroupBox>

                            <GroupBox Header="Catalog, Helper &amp; Hotkeys" Grid.Row="1">
                                <Grid Margin="8">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <StackPanel Orientation="Horizontal">
                                        <Button Content="Load Catalog" Command="{Binding LoadCatalogCommand}"/>
                                        <Button Content="Deploy Helper" Command="{Binding DeployHelperCommand}" Margin="8,0,0,0"/>
                                        <Button Content="Verify Helper" Command="{Binding VerifyHelperCommand}" Margin="8,0,0,0"/>
                                    </StackPanel>
                                    <ListBox Grid.Row="1" ItemsSource="{Binding CatalogSummary}" Margin="0,8,0,0" Height="100"/>
                                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                                        <Button Content="Load Hotkeys" Command="{Binding LoadHotkeysCommand}"/>
                                        <Button Content="Save Hotkeys" Command="{Binding SaveHotkeysCommand}" Margin="8,0,0,0"/>
                                        <Button Content="Add" Command="{Binding AddHotkeyCommand}" Margin="8,0,0,0"/>
                                        <Button Content="Remove" Command="{Binding RemoveHotkeyCommand}" Margin="8,0,0,0"/>
                                    </StackPanel>
                                    <DataGrid Grid.Row="3"
                                              ItemsSource="{Binding Hotkeys}"
                                              SelectedItem="{Binding SelectedHotkey}"
                                              AutoGenerateColumns="False"
                                              CanUserAddRows="False"
                                              Margin="0,8,0,0">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Gesture" Binding="{Binding Gesture}" Width="*"/>
                                            <DataGridTextColumn Header="Action" Binding="{Binding ActionId}" Width="*"/>
                                            <DataGridTextColumn Header="Payload JSON" Binding="{Binding PayloadJson}" Width="2*"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </GroupBox>
                        </Grid>
                    </Grid>
                </Grid>
            </TabItem>

            <TabItem Header="Live Ops">
                <Grid Margin="12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="Refresh Reliability" Command="{Binding RefreshActionReliabilityCommand}"/>
                        <Button Content="Load Spawn Presets" Command="{Binding LoadSpawnPresetsCommand}" Margin="8,0,0,0"/>
                        <Button Content="Capture Unit Baseline" Command="{Binding CaptureSelectedUnitBaselineCommand}" Margin="8,0,0,0"/>
                    </StackPanel>

                    <Grid Grid.Row="1" Grid.Column="0" Margin="0,0,10,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <GroupBox Header="Selected Unit Transaction Lab" Margin="0,0,0,10">
                            <Grid Margin="8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="Hull HP" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Column="1" Text="{Binding SelectedUnitHp}" Margin="0,0,8,6"/>
                                <TextBlock Grid.Column="2" Text="Shield" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Column="3" Text="{Binding SelectedUnitShield}" Margin="0,0,0,6"/>

                                <TextBlock Grid.Row="1" Text="Speed" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding SelectedUnitSpeed}" Margin="0,0,8,6"/>
                                <TextBlock Grid.Row="1" Grid.Column="2" Text="Damage x" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Row="1" Grid.Column="3" Text="{Binding SelectedUnitDamageMultiplier}" Margin="0,0,0,6"/>

                                <TextBlock Grid.Row="2" Text="Cooldown x" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding SelectedUnitCooldownMultiplier}" Margin="0,0,8,6"/>
                                <TextBlock Grid.Row="2" Grid.Column="2" Text="Veterancy" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Row="2" Grid.Column="3" Text="{Binding SelectedUnitVeterancy}" Margin="0,0,0,6"/>

                                <TextBlock Grid.Row="3" Text="Owner Faction" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding SelectedUnitOwnerFaction}" Margin="0,0,8,6"/>

                                <StackPanel Grid.Row="4" Grid.ColumnSpan="4" Orientation="Horizontal" Margin="0,8,0,0">
                                    <Button Content="Apply Draft" Command="{Binding ApplySelectedUnitDraftCommand}"/>
                                    <Button Content="Revert Last" Command="{Binding RevertSelectedUnitTransactionCommand}" Margin="8,0,0,0"/>
                                    <Button Content="Restore Baseline" Command="{Binding RestoreSelectedUnitBaselineCommand}" Margin="8,0,0,0"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>

                        <GroupBox Grid.Row="1" Header="Spawn Preset Studio">
                            <Grid Margin="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="Preset" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <ComboBox Grid.Column="1" Grid.ColumnSpan="3"
                                          ItemsSource="{Binding SpawnPresets}"
                                          SelectedItem="{Binding SelectedSpawnPreset}"
                                          DisplayMemberPath="Name"
                                          Margin="0,0,0,6"/>

                                <TextBlock Grid.Row="1" Text="Quantity" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding SpawnQuantity}" Margin="0,0,8,6"/>
                                <TextBlock Grid.Row="1" Grid.Column="2" Text="Delay (ms)" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Row="1" Grid.Column="3" Text="{Binding SpawnDelayMs}" Margin="0,0,0,6"/>

                                <TextBlock Grid.Row="2" Text="Faction" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding SelectedFaction}" Margin="0,0,8,6"/>
                                <TextBlock Grid.Row="2" Grid.Column="2" Text="Entry Marker" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Row="2" Grid.Column="3" Text="{Binding SelectedEntryMarker}" Margin="0,0,0,6"/>

                                <StackPanel Grid.Row="3" Grid.ColumnSpan="4" Orientation="Horizontal">
                                    <CheckBox Content="Stop on first failure" IsChecked="{Binding SpawnStopOnFailure}" VerticalAlignment="Center"/>
                                    <Button Content="Run Spawn Batch" Command="{Binding RunSpawnBatchCommand}" Margin="8,0,0,0"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>
                    </Grid>

                    <Grid Grid.Column="1" Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <GroupBox Header="Operational Diagnostics">
                            <ListBox ItemsSource="{Binding LiveOpsDiagnostics}" Height="110"/>
                        </GroupBox>

                        <GroupBox Grid.Row="1" Header="Action Reliability" Margin="0,10,0,0">
                            <DataGrid ItemsSource="{Binding ActionReliability}" AutoGenerateColumns="False" IsReadOnly="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Action" Binding="{Binding ActionId}" Width="2*"/>
                                    <DataGridTextColumn Header="State" Binding="{Binding State}" Width="*"/>
                                    <DataGridTextColumn Header="Reason" Binding="{Binding ReasonCode}" Width="2*"/>
                                    <DataGridTextColumn Header="Confidence" Binding="{Binding Confidence}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </GroupBox>

                        <GroupBox Grid.Row="2" Header="Selected Unit Transaction History" Margin="0,10,0,0">
                            <DataGrid ItemsSource="{Binding SelectedUnitTransactions}" AutoGenerateColumns="False" IsReadOnly="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Txn" Binding="{Binding TransactionId}" Width="*"/>
                                    <DataGridTextColumn Header="Time" Binding="{Binding Timestamp}" Width="*"/>
                                    <DataGridTextColumn Header="Rollback" Binding="{Binding IsRollback}" Width="*"/>
                                    <DataGridTextColumn Header="Operation" Binding="{Binding Operation}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </GroupBox>
                    </Grid>
                </Grid>
            </TabItem>

            <TabItem Header="Save Editor">
                <Grid Margin="12">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Save:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBox Text="{Binding SavePath}" Width="760"/>
                        <Button Content="Browse" Command="{Binding BrowseSaveCommand}" Margin="8,0,0,0"/>
                        <Button Content="Load" Command="{Binding LoadSaveCommand}" Margin="8,0,0,0"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Grid.Row="1" Margin="0,10,0,0">
                        <TextBlock Text="Node Path:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBox Text="{Binding SaveNodePath}" Width="360"/>
                        <TextBlock Text="Value:" VerticalAlignment="Center" Margin="12,0,8,0"/>
                        <TextBox Text="{Binding SaveEditValue}" Width="180"/>
                        <Button Content="Edit" Command="{Binding EditSaveCommand}" Margin="8,0,0,0"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Grid.Row="2" Margin="0,10,0,0">
                        <Button Content="Validate" Command="{Binding ValidateSaveCommand}"/>
                        <Button Content="Preview Diff" Command="{Binding RefreshDiffCommand}" Margin="8,0,0,0"/>
                        <Button Content="Write Edited Save" Command="{Binding WriteSaveCommand}" Margin="8,0,0,0"/>
                    </StackPanel>

                    <GroupBox Grid.Row="3" Header="Save Lab Patch Packs" Margin="0,14,0,0">
                        <Grid Margin="8">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="180"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Orientation="Horizontal" Grid.ColumnSpan="2">
                                <TextBlock Text="Patch Pack:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <TextBox Text="{Binding SavePatchPackPath}" Width="540"/>
                                <Button Content="Browse" Command="{Binding BrowsePatchPackCommand}" Margin="8,0,0,0"/>
                                <Button Content="Load Patch Pack" Command="{Binding LoadPatchPackCommand}" Margin="8,0,0,0"/>
                                <Button Content="Export Patch Pack" Command="{Binding ExportPatchPackCommand}" Margin="8,0,0,0"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Grid.Row="1" Grid.ColumnSpan="2" Margin="0,8,0,0">
                                <CheckBox Content="Strict (require exact source hash)"
                                          IsChecked="{Binding IsStrictPatchApply}"
                                          VerticalAlignment="Center"
                                          Margin="0,0,12,0"/>
                                <Button Content="Preview Patch Apply" Command="{Binding PreviewPatchPackCommand}"/>
                                <Button Content="Apply Patch Pack" Command="{Binding ApplyPatchPackCommand}" Margin="8,0,0,0"/>
                                <Button Content="Restore Last Backup" Command="{Binding RestoreBackupCommand}" Margin="8,0,0,0"/>
                                <TextBlock Text="{Binding SavePatchApplySummary}" Margin="12,0,0,0" VerticalAlignment="Center"/>
                            </StackPanel>

                            <TextBlock Grid.Row="2"
                                       Grid.ColumnSpan="2"
                                       Text="{Binding SavePatchMetadataSummary}"
                                       Margin="0,8,0,0"
                                       TextWrapping="Wrap"/>

                            <DataGrid Grid.Row="3"
                                      ItemsSource="{Binding SavePatchOperations}"
                                      AutoGenerateColumns="False"
                                      IsReadOnly="True"
                                      Margin="0,8,8,0">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Kind" Binding="{Binding Kind}" Width="*"/>
                                    <DataGridTextColumn Header="Field Path" Binding="{Binding FieldPath}" Width="2*"/>
                                    <DataGridTextColumn Header="Field Id" Binding="{Binding FieldId}" Width="*"/>
                                    <DataGridTextColumn Header="Type" Binding="{Binding ValueType}" Width="*"/>
                                    <DataGridTextColumn Header="Old" Binding="{Binding OldValue}" Width="*"/>
                                    <DataGridTextColumn Header="New" Binding="{Binding NewValue}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>

                            <DataGrid Grid.Row="3"
                                      Grid.Column="1"
                                      ItemsSource="{Binding SavePatchCompatibility}"
                                      AutoGenerateColumns="False"
                                      IsReadOnly="True"
                                      Margin="0,8,0,0">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Severity" Binding="{Binding Severity}" Width="*"/>
                                    <DataGridTextColumn Header="Code" Binding="{Binding Code}" Width="*"/>
                                    <DataGridTextColumn Header="Message" Binding="{Binding Message}" Width="2*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </GroupBox>

                    <Grid Grid.Row="4" Margin="0,16,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <TextBlock TextWrapping="Wrap"
                                   Text="Full save schema editing is profile-driven. Use field ids or schema paths in Node Path. Diff preview lists changed offsets before save write."/>
                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,8,0,0">
                            <TextBlock Text="Search:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <TextBox Text="{Binding SaveSearchQuery, UpdateSourceTrigger=PropertyChanged}" Width="320"/>
                        </StackPanel>
                        <Grid Grid.Row="2" Margin="0,8,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <DataGrid ItemsSource="{Binding FilteredSaveFields}"
                                      AutoGenerateColumns="False"
                                      IsReadOnly="True"
                                      Margin="0,0,8,0">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Path" Binding="{Binding Path}" Width="2*"/>
                                    <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*"/>
                                    <DataGridTextColumn Header="Type" Binding="{Binding ValueType}" Width="*"/>
                                    <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                            <ListBox Grid.Column="1" ItemsSource="{Binding SaveDiffPreview}"/>
                        </Grid>
                    </Grid>
                </Grid>
            </TabItem>

            <TabItem Header="Profiles &amp; Updates">
                <Grid Margin="12">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal">
                        <Button Content="Check Updates" Command="{Binding CheckUpdatesCommand}"/>
                        <Button Content="Install Selected Profile" Command="{Binding InstallUpdateCommand}" Margin="8,0,0,0"/>
                        <Button Content="Rollback Selected Profile" Command="{Binding RollbackProfileUpdateCommand}" Margin="8,0,0,0"/>
                    </StackPanel>

                    <Grid Grid.Row="1" Margin="0,12,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <GroupBox Header="Mod Compatibility Studio" Margin="0,0,8,0">
                            <Grid Margin="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="Base Profile" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Column="1" Text="{Binding OnboardingBaseProfileId}" Margin="0,0,0,6"/>

                                <TextBlock Grid.Row="1" Text="Draft Profile Id" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding OnboardingDraftProfileId}" Margin="0,0,0,6"/>

                                <TextBlock Grid.Row="2" Text="Display Name" VerticalAlignment="Center" Margin="0,0,8,6"/>
                                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding OnboardingDisplayName}" Margin="0,0,0,6"/>

                                <TextBlock Grid.Row="3" Text="Launch Samples" VerticalAlignment="Top" Margin="0,0,8,6"/>
                                <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding OnboardingLaunchSample}" AcceptsReturn="True" Height="90" VerticalScrollBarVisibility="Auto" Margin="0,0,0,6"/>

                                <StackPanel Grid.Row="4" Grid.ColumnSpan="2" Orientation="Horizontal">
                                    <Button Content="Scaffold Draft" Command="{Binding ScaffoldModProfileCommand}"/>
                                    <Button Content="Export Calibration Artifact" Command="{Binding ExportCalibrationArtifactCommand}" Margin="8,0,0,0"/>
                                    <Button Content="Build Compatibility Report" Command="{Binding BuildCompatibilityReportCommand}" Margin="8,0,0,0"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>

                        <GroupBox Grid.Column="1" Header="Ops Hardening">
                            <Grid Margin="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Output Dir:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBox Text="{Binding SupportBundleOutputDirectory}" Width="420"/>
                                </StackPanel>

                                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,8,0,0">
                                    <Button Content="Export Support Bundle" Command="{Binding ExportSupportBundleCommand}"/>
                                    <Button Content="Export Telemetry Snapshot" Command="{Binding ExportTelemetrySnapshotCommand}" Margin="8,0,0,0"/>
                                </StackPanel>

                                <TextBlock Grid.Row="2" Text="{Binding ModCompatibilitySummary}" TextWrapping="Wrap" Margin="0,8,0,0"/>

                                <ListBox Grid.Row="3" ItemsSource="{Binding ModCompatibilityRows}" Margin="0,8,0,0"/>
                            </Grid>
                        </GroupBox>
                    </Grid>

                    <Grid Grid.Row="2" Margin="0,12,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <GroupBox Header="Update Feed" Margin="0,0,8,0">
                            <ListBox ItemsSource="{Binding Updates}" />
                        </GroupBox>
                        <GroupBox Grid.Column="1" Header="Onboarding / Ops Summary">
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding OnboardingSummary}" TextWrapping="Wrap"/>
                                <Separator Margin="0,8,0,8"/>
                                <TextBlock Text="{Binding OpsArtifactSummary}" TextWrapping="Wrap"/>
                            </StackPanel>
                        </GroupBox>
                    </Grid>
                </Grid>
            </TabItem>
        </TabControl>

        <Border Grid.Row="2" Background="#0D1422" BorderBrush="#2E3E5C" BorderThickness="1" Padding="10" Margin="0,12,0,0">
            <TextBlock Text="{Binding Status}"/>
        </Border>
    </Grid>
</Window>
